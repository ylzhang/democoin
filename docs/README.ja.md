# DEMOCOIN - ハッシュパワー駆動型アルゴリズムステーブルコイン

DEMOCOINは、革新的な経済モデルとプルーフ・オブ・ワーク（PoW）メカニズムを通じて価格安定性を実現する、イーサリアムベースのアルゴリズムステーブルコインです。このシステムは、ハッシュベースのプルーフ・オブ・ワークマイニングとアルゴリズム価格安定化を組み合わせ、堅牢なステーブルコインエコシステムを作成します。

## 目次

1. [プロジェクト概要](#プロジェクト概要)
2. [コア設計哲学](#コア設計哲学)
3. [技術アーキテクチャ](#技術アーキテクチャ)
4. [クイックスタート](#クイックスタート)
5. [ユーザーガイド](#ユーザーガイド)
6. [開発ガイド](#開発ガイド)
7. [セキュリティ考慮事項](#セキュリティ考慮事項)
8. [貢献ガイド](#貢献ガイド)
9. [ライセンス](#ライセンス)

## 言語切り替え

- [English](../README.md) | [简体中文](README.zh-CN.md) | [繁體中文](README.zh-TW.md) | [日本語](README.ja.md)

## プロジェクト概要

### DEMOCOINとは？

DEMOCOINは、ハッシュパワー駆動型のアルゴリズムステーブルコインであり、以下の要素を組み合わせています：
- ハッシュベースのプルーフ・オブ・ワークマイニングメカニズム
- アルゴリズム価格安定化
- ハイブリッド安定化モデル（アルゴリズム + 担保）
- 流動性提供のためのステーブルプール
- 緊急保護メカニズム

### 主な機能

- **ハッシュパワー証明メカニズム**：暗号化パズルを通じてマイナーの貢献を検証
- **アルゴリズム安定化**：需給に基づく動的価格調整
- **ステーブルプール**：ユーザーはトークンを預けて流動性を提供し、報酬を獲得
- **担保システム**：安定性を高めるための150%過剰担保
- **緊急モード**：極端な変動期間中に自動的に有効化
- **ガバナンス**：パラメータ管理のためのロールベースアクセス制御

## コア設計哲学

### 1. ハッシュパワー証明メカニズム
- ハッシュベースのプルーフ・オブ・ワーク（PoW）システム
- 公正なハッシュパワー検証のための調整可能な難易度パラメータ
- 透明なハッシュパワー貢献記録と報酬メカニズム

### 2. アルゴリズム安定化メカニズム
- 需給バランス調整：トークン供給とステーブルプール需要に基づく動的価格調整
- ステーブルプール：市場変動を吸収し、流動性サポートを提供
- 価格調整アルゴリズム：需給比率に基づく漸進的調整

### 3. 経済モデル
- ハッシュパワー貢献に比例したトークン発行
- ステーブルプール報酬メカニズム
- 価格調整と報酬分配の連携メカニズム

## 技術アーキテクチャ

### スマートコントラクト

#### HashProof.sol
**目的**：マイナーが提出したハッシュ証明を検証し、ハッシュパワー貢献を記録します。

**主な機能**：
- ハッシュベースのプルーフ・オブ・ワーク検証
- 調整可能な難易度パラメータ
- ネットワークハッシュレートに基づく自動難易度調整
- スパム防止のための証明クールダウン
- 重要な関数のアクセス制御

**コア関数**：
- `verifyProof()`：マイナーが提出したハッシュ証明を検証
- `submitHashPower()`：有効なハッシュパワー貢献を記録
- `calculateHashPower()`：難易度と解の品質に基づいてハッシュパワーを計算
- `adjustDifficulty()`：証明率に基づいて難易度を自動調整

#### DEMOCOIN.sol
**目的**：ERC20機能、マイニング報酬、安定化メカニズムを実装するコアステーブルコインコントラクト。

**主な機能**：
- 取引手数料付きERC20トークン実装
- ハッシュパワーベースのマイニング報酬
- ハイブリッド安定化モデル（アルゴリズム + 担保）
- 流動性提供のためのステーブルプール
- 手数料分配のための保険基金、開発基金、マーケティング基金
- 緊急モード機能
- ガバナンスのためのロールベースアクセス制御

**コア関数**：
- `mint()`：新しいトークンを発行（管理者のみ）
- `claimMiningReward()`：ハッシュパワーに基づいてマイナーに報酬を分配
- `depositToStablePool()`：ユーザーがトークンをステーブルプールに預けることを許可
- `withdrawFromStablePool()`：ユーザーがステーブルプールから引き出すことを許可
- `depositCollateral()`：ユーザーが担保を預けることを許可
- `withdrawCollateral()`：ユーザーが担保を引き出すことを許可
- `updatePrice()`：需給比率に基づいてトークン価格を更新
- `setEmergencyMode()`：緊急モードを有効化/無効化（管理者のみ）
- `collectFees()`：手数料を収集し、基金に分配
- `getTotalSupply()`：トークン総供給量を返す
- `getStablePoolAPY()`：現在のステーブルプールAPYを返す
- `isEmergencyMode()`：緊急モードが有効かどうかを確認
- `calculateMaxBorrowable()`：担保に基づいて最大借り入れ可能額を計算

### 開発フレームワーク

- **Ethereum**：成熟したパブリックブロックチェーンプラットフォーム
- **Solidity**：スマートコントラクトプログラミング言語（v0.8.24）
- **Hardhat**：開発、テスト、デプロイメントフレームワーク（v3.1.2）
- **OpenZeppelin**：安全なスマートコントラクトライブラリ（v5.4.0）
- **React**：フロントエンドフレームワーク
- **Vite**：フロントエンドビルドツール
- **TailwindCSS**：CSSフレームワーク
- **Ethers.js**：コントラクトインタラクション用Web3ライブラリ

### プロジェクト構造

```
democoin/
├── contracts/              # スマートコントラクトファイル
│   ├── HashProof.sol       # ハッシュプルーフ・オブ・ワークコントラクト
│   └── DEMOCOIN.sol        # コアステーブルコインコントラクト
├── test/                   # テストファイル
│   └── DEMOCOIN.test.js    # コントラクトテストケース
├── scripts/                # デプロイメントおよび管理スクリプト
│   └── deploy.cjs          # コントラクトデプロイスクリプト
├── frontend/               # フロントエンドアプリケーション
│   ├── src/                # フロントエンドソースコード
│   │   ├── abi/            # コントラクトABI
│   │   ├── components/     # Reactコンポーネント
│   │   ├── context/        # Reactコンテキストプロバイダー
│   │   ├── hooks/          # カスタムReactフック
│   │   ├── pages/          # Reactページ
│   │   └── main.jsx        # フロントエンドエントリーポイント
│   ├── package.json        # フロントエンド依存関係
│   ├── vite.config.js      # Vite設定
│   └── tailwind.config.js  # TailwindCSS設定
├── hardhat.config.js       # Hardhat設定
├── package.json            # プロジェクト依存関係
├── .env.example            # 環境変数の例
└── README.md               # プロジェクトドキュメント
```

## クイックスタート

### 前提条件

- Node.js（v16以上）
- npmまたはyarnパッケージマネージャー
- Gitバージョン管理
- MetaMaskブラウザ拡張機能（フロントエンドテスト用）
- イーサリアム、Solidity、Reactの基本的な理解

### インストール

1. リポジトリをクローン：
```bash
git clone https://github.com/yourusername/democoin.git
cd democoin
```

2. バックエンド依存関係をインストール：
```bash
# ルート依存関係をインストール（スマートコントラクト用）
npm install --legacy-peer-deps
```

3. コントラクトをコンパイル：
```bash
npx hardhat compile
```

4. テストを実行：
```bash
npx hardhat test
```

5. フロントエンド依存関係をインストール：
```bash
# フロントエンドディレクトリに移動
cd frontend

# フロントエンド依存関係をインストール
npm install --legacy-peer-deps

# プロジェクトルートに戻る
cd ..
```

### ローカル開発

#### ローカルブロックチェーンを開始

```bash
# ローカルHardhatネットワークを開始
npx hardhat node
```

#### ローカルネットワークにコントラクトをデプロイ

```bash
# 新しいターミナルで、コントラクトをローカルネットワークにデプロイ
npx hardhat run scripts/deploy.cjs --network localhost
```

#### フロントエンド開発サーバーを開始

```bash
# フロントエンドディレクトリに移動
cd frontend

# Vite開発サーバーを開始
npm run dev

# フロントエンドは http://localhost:5173 で利用可能
```

### デプロイメント

#### テストネット（例：Sepolia）

**必須の設定要素：**

| 要素 | 説明 | 例 |
|------|------|------|
| `SEPOLIA_RPC_URL` | SepoliaテストネットRPCエンドポイント | `https://sepolia.infura.io/v3/YOUR_INFURA_API_KEY` |
| `PRIVATE_KEY` | デプロイ用イーサリアム秘密鍵（64文字の16進文字列） | `0x1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef` |
| `ETHERSCAN_API_KEY` | コントラクト検証用Etherscan APIキー | `ABCDEFGHIJKLMNOPQRSTUVWXYZ123456` |

**操作ガイド：**

1. **環境変数を設定**：
   ```bash
   # テンプレートファイルをコピー
   cp .env.example .env
   
   # .envファイルを編集して設定を追加
   # vimやnanoなどのテキストエディタを使用
   vim .env
   ```

2. **Sepoliaテストネットにデプロイ**：
   ```bash
   npx hardhat run scripts/deploy.cjs --network sepolia
   ```

3. **フロントエンドコントラクトアドレスを更新**：
   - デプロイ出力からデプロイされたコントラクトアドレスをコピー
   - `frontend/src/hooks/useContract.jsx`を編集してコントラクトアドレスを更新

4. **本番環境フロントエンドをビルド**：
   ```bash
   cd frontend
   npm run build
   ```

**注意事項：**
- 本物の秘密鍵を含む.envファイルをバージョン管理にコミットしないでください
- コントラクトデプロイメントにはテストネットETHが必要です。アカウントに十分な残高があることを確認してください
- デプロイ前にローカルネットワークでデプロイスクリプトをテストすることをお勧めします
- デプロイ後は、透明性を確保するためにEtherscanでコントラクトを検証してください

## ユーザーガイド

### マイニングガイド

#### 概要

DEMOCOINはハッシュベースのプルーフ・オブ・ワーク（PoW）メカニズムを使用しています。マイナーは暗号化パズルを解くことで有効なハッシュ証明を生成し、ハッシュパワー貢献に基づいてDEMOトークンの報酬を受け取ります。

#### ステップ1：MINER_ROLEを取得

DEMOをマイニングするには、コントラクト管理者からMINER_ROLEを付与される必要があります。DEMOCOINチームに連絡してこのロールをリクエストしてください。

#### ステップ2：ハッシュ証明を生成

1. ネットワークからチャレンジを取得
2. ランダムなナンスを生成
3. チャレンジとナンスのハッシュを計算
4. ハッシュが難易度要件を満たしているか確認
5. 有効なソリューションが見つかるまで繰り返す

**証明生成コードの例（JavaScript）**：

```javascript
const { ethers } = require('ethers');

async function generateProof(challenge, difficulty) {
    let nonce = 0;
    let solution;
    const target = BigInt(2) ** (256n - BigInt(difficulty));
    
    do {
        solution = ethers.keccak256(ethers.solidityPacked(['bytes32', 'uint256'], [challenge, nonce]));
        nonce++;
    } while (BigInt(solution) >= target);
    
    return {
        challenge: challenge,
        nonce: nonce - 1,
        solution: solution
    };
}
```

#### ステップ3：ハッシュ証明を提出

1. HashProofコントラクトに接続
2. 生成した証明で`submitHashPower(proof)`を呼び出す
3. ガス料金を支払う
4. トランザクションの確認を待つ

#### ステップ4：マイニング報酬を請求

1. DEMOCOINコントラクトに接続
2. `claimMiningReward()`を呼び出す
3. ガス料金を支払う
4. トランザクションの確認を待つ
5. DEMO報酬がウォレットに追加されます

### ステーブルプールガイド

#### 概要

ステーブルプールは、ユーザーがDEMOトークンを預けて流動性を提供し、トークン価格を安定させることができます。その見返りとして、ユーザーはステーブルプールAPYに基づいて利息を受け取ります。

#### ステップ1：トークンを預ける

1. ウォレットにDEMOトークンがあることを確認
2. DEMOCOINコントラクトに接続
3. 預けたいDEMOの量で`depositToStablePool(amount)`を呼び出す
4. ガス料金を支払う
5. トランザクションの確認を待つ
6. 預金に比例したステーブルプールシェアを受け取ります

#### ステップ2：利息を獲得

- 利息はステーブルプールAPYに基づいて自動的に蓄積されます
- 現在のAPY：5%
- 利息はブロックごとに計算されます

#### ステップ3：報酬を請求

1. DEMOCOINコントラクトに接続
2. `claimStablePoolRewards()`を呼び出す
3. ガス料金を支払う
4. トランザクションの確認を待つ
5. 利息報酬がウォレットに追加されます

#### ステップ4：トークンを引き出す

1. DEMOCOINコントラクトに接続
2. 換金したいシェア数で`withdrawFromStablePool(shares)`を呼び出す
3. ガス料金を支払う
4. トランザクションの確認を待つ
5. DEMOトークン（元本 + 未請求の利息）がウォレットに返されます

### 担保システム

#### 概要

DEMOCOINは安定性を高めるために150%過剰担保システムを使用しています。ユーザーは担保としてDEMOトークンを預けることができ、これは市場変動期間中にトークンの価値を維持するのに役立ちます。

#### ステップ1：担保を預ける

1. ウォレットにDEMOトークンがあることを確認
2. DEMOCOINコントラクトに接続
3. 預けたいDEMOの量で`depositCollateral(amount)`を呼び出す
4. ガス料金を支払う
5. トランザクションの確認を待つ
6. 預金に比例した担保シェアを受け取ります

#### ステップ2：担保を引き出す

1. DEMOCOINコントラクトに接続
2. 換金したいシェア数で`withdrawCollateral(shares)`を呼び出す
3. ガス料金を支払う
4. トランザクションの確認を待つ
5. DEMOトークンがウォレットに返されます

**注意**：引き出しにより担保比率が150%未満になる場合、または緊急モードが有効な場合、引き出しは制限されます。

## 開発ガイド

### 経済モデル

#### トークノミクス

- **最大供給量**：100,000,000 DEMO
- **初期マイニング報酬率**：100ハッシュレートあたり毎日100 DEMO
- **報酬半減**：マイニング報酬の年次半減
- **取引手数料**：取引ごとに0.3%
- **マイニング手数料**：マイニング報酬の0.2%
- **ステーブルプール手数料**：ステーブルプール預入/引き出しの0.1%

#### 安定化メカニズム

##### アルゴリズム調整

- **価格調整**：需給比率に基づく漸進的価格変動
- **報酬調整**：目標価格からの乖離に基づくマイニング報酬のスケーリング
- **供給管理**：最大供給上限と年次報酬半減

##### ハイブリッド安定化

- **ステーブルプール**：ユーザーはトークンを預けて流動性を提供し、価格を安定させる
- **担保システム**：150%過剰担保要件
- **保険基金**：市場ショックを吸収するために手数料を蓄積
- **緊急モード**：極端な変動期間中に有効化され、重要な機能を一時停止

#### 手数料分配

| 手数料タイプ | パーセンテージ | 分配 |
|----------|------------|--------------|
| 取引 | 0.3% | 燃焼（当面） |
| マイニング | 0.2% | 燃焼（当面） |
| ステーブルプール | 0.1% | 燃焼（当面） |

**将来の分配計画**：
- 保険基金に50%
- 開発基金に30%
- マーケティング基金に20%

### 技術フロー

#### マイニングプロセス

1. マイナーは暗号化パズルを解くことでハッシュ証明を生成
2. マイナーは証明を`HashProof.submitHashPower()`に提出
3. コントラクトは証明を検証し、ハッシュパワー貢献を記録
4. マイナーは`DEMOCOIN.claimMiningReward()`を通じて報酬を請求
5. コントラクトはハッシュパワーと価格調整に基づいて報酬を計算
6. 新しいトークンが発行され、マイナーに分配される
7. 新しい供給に基づいてトークン価格が更新される

#### ステーブルプール操作

1. ユーザーはDEMOトークンを`DEMOCOIN.depositToStablePool()`に預ける
2. コントラクトは預金に比例したステーブルプールシェアを発行
3. ユーザーはstablePoolAPYに基づいて利息を受け取る
4. ユーザーは`DEMOCOIN.claimStablePoolRewards()`を通じて報酬を請求
5. ユーザーは`DEMOCOIN.withdrawFromStablePool()`を通じてトークンを引き出す
6. コントラクトはシェアを燃焼し、手数料を差し引いてトークンを返す

#### 価格更新メカニズム

1. コントラクトは価格更新間隔が経過したかどうかを確認
2. オラクルが設定されている場合、外部価格データを取得
3. それ以外の場合、需給比率に基づいて価格を計算
4. 現在の価格を更新し、PriceUpdatedイベントを発行
5. 変動閾値の超過を確認
6. 変動が閾値を超える場合、緊急モードを有効化

### セキュリティモデル

#### アクセス制御

- **DEFAULT_ADMIN_ROLE**：最高権限、すべてのロールを付与/取り消し可能
- **ADMIN_ROLE**：一時停止/再開、オラクル更新、緊急モード管理が可能
- **GOVERNOR_ROLE**：経済パラメータ、手数料、APYを調整可能
- **MINER_ROLE**：ハッシュ証明を提出可能
- **FEE_COLLECTOR_ROLE**：蓄積された手数料を収集可能

#### リスク軽減

- **緊急一時停止**：極端な条件下で重要な機能を一時停止可能
- **緊急モード**：高変動期間中に自動的に有効化
- **担保比率**：150%過剰担保を維持
- **最大供給量**：トークン総発行量を制限
- **漸進的調整**：価格変動を更新ごとに0.5%に制限
- **取引手数料**：保険基金の収入を生成

#### セキュリティベストプラクティス

- OpenZeppelinの安全なコントラクトライブラリを使用
- 外部呼び出しにReentrancyGuardを実装
- すべての入力と状態を検証
- すべての重要な操作に対してイベントを発行
- 最小権限の原則に従う

### ガバナンス

#### ガバナンスロール

- **DEFAULT_ADMIN_ROLE**：最高権限、すべてのロールを付与/取り消し可能
- **ADMIN_ROLE**：一時停止/再開、オラクル更新、緊急モード管理が可能
- **GOVERNOR_ROLE**：経済パラメータ、手数料、APYを調整可能

#### ガバナンスパラメータ

| パラメータ | 説明 | 現在の値 | 調整可能 |
|----------|------|----------|----------|
| `stablePoolAPY` | ステーブルプール年利 | 5% | はい |
| `priceUpdateInterval` | 価格更新間隔 | 1時間 | はい |
| `maxPriceChange` | 最大価格変動 | 0.5% | はい |
| `emergencyThreshold` | 緊急モード閾値 | 10% | はい |
| `minCollateralRatio` | 最小担保比率 | 150% | はい |
| `maxSupply` | 最大供給量 | 100M | いいえ |

## セキュリティ考慮事項

### 既知のリスク

1. **スマートコントラクトの脆弱性**：
   - 再入攻撃
   - 整数オーバーフロー/アンダーフロー
   - アクセス制御の不備

2. **経済的リスク**：
   - 極端な市場変動
   - 流動性不足
   - 価格操作攻撃

3. **オラクルのリスク**：
   - オラクル操作
   - データ遅延
   - オラクル障害

4. **ガバナンスリスク**：
   - 悪意ある管理者
   - ガバナンス攻撃
   - パラメータ設定ミス

### セキュリティ監査

コントラクトは以下のセキュリティ監査を受けています：

| 監査 | 日付 | 結果 | レポート |
|------|------|------|----------|
| 内部監査 | 2024年1月 | 合格 | - |
| 外部監査 | 2024年2月 | 保留 | - |

### ベストプラクティス

**ユーザー向け**：
- 小額から始めて徐々に増やす
- 緊急モード通知を監視する
- 担保比率を定期的に確認する
- 公式チャンネルから情報を取得する

**開発者向け**：
- コードレビューを実施する
- 包括的なテストを行う
- バグバウンティプログラムに参加する
- セキュリティ監査を受ける

## 貢献ガイド

### 開発者として貢献する

DEMOCOINは、コード、ドキュメント、バグ報告、機能リクエストの形で貢献を歓迎します！

#### 開発環境のセットアップ

1. リポジトリをフォークする
2. フォークをクローンする：
   ```bash
   git clone https://github.com/yourusername/democoin.git
   cd democoin
   ```
3. 新しいブランチを作成する：
   ```bash
   git checkout -b feature/your-feature-name
   ```
4. 変更を加える
5. テストを実行する：
   ```bash
   npx hardhat test
   ```
6. 変更をコミットする：
   ```bash
   git add .
   git commit -m "Add your feature"
   ```
7. ブランチをプッシュする：
   ```bash
   git push origin feature/your-feature-name
   ```
8. プルリクエストを作成する

#### コードスタイル

- SolidityコードはSolidity Style Guideに従う
- JavaScript/ReactコードはAirbnb Style Guideに従う
- コメントを明確に記述する
- 変数名と関数名は説明的にする

#### テスト要件

- 新しい機能には単体テストを追加する
- すべてのテストが合格することを確認する
- テストカバレッジを80%以上維持する

#### プルリクエストガイドライン

- プルリクエストの説明に変更内容を記述する
- 関連するIssueを参照する
- 小さく、焦点を絞ったプルリクエストを作成する
- コードレビューのフィードバックに応答する

### バグ報告

バグを見つけた場合は、GitHub Issuesで報告してください。バグ報告には以下の情報を含めてください：

- バグの明確な説明
- 再現手順
- 期待される動作
- 実際の動作
- スクリーンショット（該当する場合）
- 環境情報（OS、ブラウザ、Node.jsバージョンなど）

### 機能リクエスト

新しい機能の提案を歓迎します。機能リクエストには以下の情報を含めてください：

- 機能の明確な説明
- その機能が解決する問題
- 提案される実装方法
- 代替案（該当する場合）

## お問い合わせ

### プロジェクトチーム

- **プロジェクトリーダー**：DEMOCOINチーム
- **開発チーム**：DEMOCOIN開発者
- **コミュニティマネージャー**：DEMOCOINコミュニティ

### 連絡先

- **GitHub Issues**：[https://github.com/yourusername/democoin/issues](https://github.com/yourusername/democoin/issues)
- **Discord**：[DEMOCOIN Discord](https://discord.gg/democoin)
- **Twitter**：[@DEMOCOIN](https://twitter.com/democoin)
- **Email**：contact@democoin.io

### フィードバックと貢献

DEMOCOINプロジェクトへのフィードバックと貢献を歓迎します！

**フィードバックの方法**：
- GitHub Issuesでバグ報告や機能リクエストを提出する
- Discordでコミュニティと議論する
- Twitterでプロジェクトの最新情報をフォローする
- プルリクエストを通じてコードを貢献する

**貢献の方法**：
- コードを書いてプルリクエストを送る
- ドキュメントを改善する
- バグを報告する
- 新しい機能を提案する
- コミュニティを助ける

私たちは、DEMOCOINをより良くするためのすべての貢献に感謝します。一緒に、より良いステーブルコインエコシステムを構築しましょう！

## ライセンス

DEMOCOINはMITライセンスの下でライセンスされています。詳細については[LICENSE](LICENSE)ファイルを参照してください。

---

**DEMOCOIN - ハッシュパワー駆動型アルゴリズムステーブルコイン**

*ハッシュパワーとアルゴリズム安定化の力で、より良いステーブルコインの未来を構築しましょう！*